# 📑 接口文档（API Spec）

## 1. 认证 / 用户

> 本应用不做登录注册，用户数据默认匿名存储（可扩展为 deviceId / localId 作为用户标识）

---

## 2. 时间块（TimeBlocks）

### 2.1 创建时间块

`POST /time-blocks`

```json
{
  "title": "上午学习",
  "date": "2025-08-21",
  "endTime": "10:30",
  "repeat": { "type": "weekly", "days": [1, 3, 5] }
}
```

**响应**

```json
{
  "id": "tb123",
  "title": "上午学习",
  "startTime": "08:00",
  "endTime": "10:30",
  "repeat": { "type": "weekly", "days": [1, 3, 5] },
  "createdAt": "2025-08-21T08:00:00Z"
}
```

### 2.2 获取某天的时间块列表

`GET /time-blocks?date=2025-08-21`

### 2.3 修改时间块

`PUT /time-blocks/:id`

### 2.4 删除时间块

`DELETE /time-blocks/:id`

---

## 3. 任务（Tasks）

### 3.1 创建任务

`POST /tasks`

```json
{
  "blockId": "tb123",
  "title": "写需求文档",
  "category": "work",
  "estimatedTime": 25,
  "repeat": { "type": "daily", "interval": 1 },
  "executionCount": 1
}
```

**响应**

```json
{
  "id": "task456",
  "title": "写需求文档",
  "status": "pending",
  "estimatedTime": 25,
  "createdAt": "2025-08-21T08:10:00Z"
}
```

### 3.2 获取时间块下任务列表

`GET /time-blocks/:id/tasks`

### 3.3 修改任务

`PUT /tasks/:id`

### 3.4 删除任务

`DELETE /tasks/:id`

### 3.5 开始计时

`POST /tasks/:id/start`

响应：返回任务状态（inProgress）+ 计时开始时间

### 3.6 暂停计时

`POST /tasks/:id/pause`

### 3.7 完成任务

`POST /tasks/:id/complete`

```json
{
  "actualTime": 22,
  "completedAt": "2025-08-21T09:00:00Z"
}
```

---

## 4. 思考（TreeView / Thoughts）

### 4.1 创建思考节点

`POST /thoughts`

```json
{
  "title": "学习计划",
  "parentId": null,
  "category": "mind"
}
```

### 4.2 获取树结构

`GET /thoughts`

### 4.3 修改思考节点

`PUT /thoughts/:id`

### 4.4 删除思考节点

`DELETE /thoughts/:id`

### 4.5 节点作为任务 → 复用任务接口

支持 `POST /thoughts/:id/start`（开始计时）、`/complete`（完成）

---

## 5. 安排（日历安排）

### 5.1 获取某月任务

`GET /schedule?month=2025-08`

返回该月每天的任务（已完成 / 未完成）

---

## 6. 待处理事项

### 6.1 获取待处理事项

`GET /pending-tasks`
返回所有未完成任务（按时间排序）

---

## 7. 搜索

### 7.1 搜索任务/思考

`GET /search?q=学习`
返回标题 / 备注中包含关键词的任务或思考

---

## 8. 用户数据 / 设置

### 8.1 获取用户统计

`GET /user/stats`

```json
{
  "completedTasks": 123,
  "totalTime": 452,
  "joinDate": "2025-08-01"
}
```

### 8.2 获取设置

`GET /user/settings`

### 8.3 修改设置

`PUT /user/settings`

```json
{
  "theme": "dark",
  "defaultCategory": "work",
  "defaultDuration": 25,
  "soundEnabled": true
}
```

---

## 9. 提醒（Reminders）

### 9.1 设置提醒

`POST /tasks/:id/reminder`

```json
{
  "date": "2025-08-21",
  "time": "08:30"
}
```

### 9.2 删除提醒

`DELETE /tasks/:id/reminder`

---

## 10. 响应规范

- 成功：`{ "success": true, "data": { ... } }`
- 失败：`{ "success": false, "errorCode": "TASK_NOT_FOUND", "message": "任务不存在" }`
