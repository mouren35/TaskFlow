# ğŸ“˜ æŠ€æœ¯æ–‡æ¡£ï¼ˆTSDï¼‰

## 1. æŠ€æœ¯é€‰å‹ç›®æ ‡

- **å¿«é€Ÿå¼€å‘**ï¼šæœ€å¤§åŒ–åˆ©ç”¨ Meteor çš„å…¨æ ˆä¼˜åŠ¿ï¼ˆå®æ—¶æ•°æ®ã€å†…ç½® buildã€çƒ­æ›´æ–°ï¼‰ã€‚
- **å‡å°‘é‡å¤ä»£ç **ï¼šMVVM æ¶æ„ + React hooks/state ç®¡ç†ã€‚
- **è·¨å¹³å°æ”¯æŒ**ï¼šä¸€æ¬¡å¼€å‘ï¼Œæ”¯æŒ Android / iOSã€‚
- **æµç•…ä½“éªŒ**ï¼šä½¿ç”¨åŠ¨ç”»åº“å’Œæ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼Œä¿è¯äº¤äº’ä¸æ»‘ã€‚
- **æ•°æ®ç®€å•åŒ–**ï¼šæœ¬åœ°ä¼˜å…ˆï¼ŒMongoDB æŒä¹…åŒ–å­˜å‚¨ï¼Œæ”¯æŒç¦»çº¿ç¼“å­˜ã€‚

---

## 2. æŠ€æœ¯æ ˆ

### 2.1 å‰ç«¯

- **æ¡†æ¶**ï¼šReact + TypeScript
- **æ¶æ„æ¨¡å¼**ï¼šMVVM

  - **View**ï¼šReact ç»„ä»¶ï¼ˆUI å±‚ï¼ŒMaterial UI + è‡ªå®šä¹‰ç»„ä»¶ï¼‰
  - **ViewModel**ï¼šReact Hooksï¼ˆçŠ¶æ€é€»è¾‘ã€ä»»åŠ¡ç®¡ç†ã€è®¡æ—¶å™¨é€»è¾‘ï¼‰
  - **Model**ï¼šMongoDB Collectionsï¼ˆä»»åŠ¡ã€æ—¶é—´å—ã€ä¹ æƒ¯ã€æ€è€ƒèŠ‚ç‚¹ç­‰æ•°æ®æ¨¡å‹ï¼‰

- **UI åº“**ï¼šMaterial UIï¼ˆåŸºç¡€ç»„ä»¶ï¼Œé£æ ¼ç»Ÿä¸€ï¼Œç±»ä¼¼ Google Appï¼‰
- **åŠ¨ç”»åº“**ï¼šMotionï¼ˆé¡µé¢åˆ‡æ¢ã€ä»»åŠ¡å±•å¼€æ”¶èµ·ã€FAB åŠ¨ç”»ç­‰ï¼‰
- **çŠ¶æ€ç®¡ç†**ï¼š

  - Meteor è‡ªå¸¦ reactive data sourcesï¼ˆminimongoï¼‰
  - React Context / Zustandï¼ˆè½»é‡çŠ¶æ€ç®¡ç†ï¼Œæ›¿ä»£ Reduxï¼Œé¿å…è¿‡åº¦å¤æ‚åŒ–ï¼‰

- **è·¯ç”±**ï¼šReact Router v6ï¼ˆé¡µé¢å¯¼èˆªï¼šè®¡åˆ’ / å®‰æ’ / æ€è€ƒ / æˆ‘çš„ï¼‰

### 2.2 åç«¯

- **å¹³å°**ï¼šMeteorï¼ˆé›†æˆ Node.js + DDP + Build systemï¼‰
- **æ•°æ®åº“**ï¼šMongoDBï¼ˆMeteor å†…ç½®æ”¯æŒï¼Œæ–‡æ¡£å‹æ•°æ®åº“ï¼Œé€‚åˆä»»åŠ¡/æ—¶é—´å—ç»“æ„ï¼‰
- **æ•°æ®è®¢é˜…**ï¼šMeteor Publish/Subscribeï¼ˆå®æ—¶æ•°æ®åŒæ­¥ï¼‰
- **ä»»åŠ¡è°ƒåº¦**ï¼šNode-cronï¼ˆå¤„ç†ä»»åŠ¡æé†’/å®šæ—¶å™¨åˆ°æœŸäº‹ä»¶ï¼‰

### 2.3 ç§»åŠ¨ç«¯æ”¯æŒ

- **è·¨å¹³å°è¿è¡Œæ—¶**ï¼šMeteor + Cordovaï¼ˆå¿«é€Ÿå°è£…ï¼Œé€‚åˆ MVP å°åº”ç”¨ï¼‰
- **æœªæ¥å¯æ‰©å±•**ï¼šå¯æ›¿æ¢ä¸º React Nativeï¼ˆå¦‚éœ€æ›´é«˜æ€§èƒ½ï¼‰

### 2.4 å·¥ç¨‹åŒ–ä¸å·¥å…·

- **æ„å»ºå·¥å…·**ï¼šMeteor å†…ç½®æ„å»ºï¼ˆæ”¯æŒçƒ­æ›´æ–°ï¼‰
- **ä»£ç è§„èŒƒ**ï¼š

  - ESLint + Prettierï¼ˆä»£ç é£æ ¼ç»Ÿä¸€ï¼‰
  - Husky + lint-stagedï¼ˆæäº¤å‰æ ¡éªŒï¼‰

- **åŒ…ç®¡ç†**ï¼šnpm / yarn
- **ç‰ˆæœ¬ç®¡ç†**ï¼šGitï¼ˆGitHub/GitLabï¼Œè¯­ä¹‰åŒ– commitï¼‰
- **å•å…ƒæµ‹è¯•**ï¼šJest + React Testing Library
- **E2E æµ‹è¯•**ï¼šCypressï¼ˆä»»åŠ¡æµã€è®¡æ—¶å™¨æµï¼‰

### 2.5 åŠ¨ç”»ä¸ä½“éªŒä¼˜åŒ–

- **åŠ¨ç”»**ï¼šMotionï¼ˆFAB å±•å¼€ã€ä»»åŠ¡æŠ˜å ã€TreeView åŠ¨æ•ˆï¼‰
- **æ€§èƒ½ä¼˜åŒ–**ï¼š

  - React.lazy + Suspenseï¼ˆæŒ‰éœ€åŠ è½½ï¼‰
  - Virtualized Listï¼ˆé•¿åˆ—è¡¨ä»»åŠ¡ä¼˜åŒ–ï¼Œå¦‚ react-windowï¼‰
  - MongoDB ç´¢å¼•ä¼˜åŒ–ï¼ˆä»»åŠ¡æ—¶é—´ / çŠ¶æ€å­—æ®µï¼‰

---

## 3. æ•°æ®åº“è®¾è®¡ï¼ˆMongoDB Collectionsï¼‰

### 3.1 æ—¶é—´å—ï¼ˆtimeBlocksï¼‰

```ts
{
  _id: string,
  title: string,
  date: Date,
  startTime: string, // 08:00
  endTime: string,   // 09:30
  repeat: { type: 'daily' | 'weekly' | 'monthly' | 'none', rule: any },
  createdAt: Date,
  updatedAt: Date
}
```

### 3.2 ä»»åŠ¡ï¼ˆtasksï¼‰

```ts
{
  _id: string,
  blockId: string,       // å…³è”æ—¶é—´å—
  title: string,
  category: 'social' | 'mind' | 'health' | 'work' | 'hobby',
  estimatedTime: number, // é¢„è®¡åˆ†é’Ÿ
  actualTime?: number,
  repeat?: object,
  status: 'pending' | 'inProgress' | 'completed',
  notes?: string,
  createdAt: Date,
  completedAt?: Date
}
```

### 3.3 æ€è€ƒï¼ˆthoughtsï¼‰

```ts
{
  _id: string,
  parentId?: string,  // TreeView çˆ¶èŠ‚ç‚¹
  title: string,
  category: 'social' | 'mind' | 'health' | 'work' | 'hobby',
  estimatedTime: number, // é¢„è®¡åˆ†é’Ÿ
  actualTime?: number,
  notes?: string,
  status: 'pending' | 'completed',
  createdAt: Date,
  completedAt?: Date
}
```

### 3.4 ç”¨æˆ·æ•°æ®ï¼ˆuserStatsï¼‰

```ts
{
  _id: string,
  completedTasks: number,
  totalTime: number,   // å°æ—¶
  joinDate: Date
}
```

---

## 4. ç³»ç»Ÿæ¶æ„

```
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         View (UI)         â”‚
       â”‚ React + Material UI       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚     ViewModel (é€»è¾‘å±‚)    â”‚
       â”‚ React Hooks / Zustand     â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚      Model (æ•°æ®å±‚)       â”‚
       â”‚ MongoDB Collections       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    Meteor Publish/Sync    â”‚
       â”‚ Cordova runtime (ç§»åŠ¨ç«¯) â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. å¼€å‘è§„èŒƒ

1. **ä»£ç ç›®å½•ç»“æ„**

```
/client   â†’ React ç»„ä»¶ & ViewModel
/server   â†’ Meteor æœåŠ¡ç«¯é€»è¾‘ (publish, cron jobs)
/imports  â†’ å…¬å…±ä»£ç ï¼ˆmodels, hooks, utilsï¼‰
/imports/ui       â†’ Material UI è‡ªå®šä¹‰ä¸»é¢˜ & æ ·å¼
/tests    â†’ å•å…ƒæµ‹è¯• & E2E
```

2. **å‘½åè§„èŒƒ**

- æ–‡ä»¶åï¼škebab-case
- React ç»„ä»¶ï¼šPascalCase
- Hooksï¼šuseXxx
- Mongo é›†åˆï¼šå¤æ•°å½¢å¼ï¼ˆtasks, timeBlocksï¼‰

3. **æ¥å£è§„èŒƒ**

- æ‰€æœ‰æ•°æ®é€šè¿‡ Meteor methods / publications
- é”™è¯¯ç»Ÿä¸€è¿”å› `{ errorCode, message }`

---

## 6. éåŠŸèƒ½éœ€æ±‚å®ç°æ–¹æ¡ˆ

- **æµç•…åŠ¨ç”»**ï¼šMotion + requestAnimationFrame
- **ç¦»çº¿æ”¯æŒ**ï¼šMeteor å†…ç½® minimongoï¼ˆæœ¬åœ°ç¼“å­˜ï¼Œç½‘ç»œæ¢å¤è‡ªåŠ¨åŒæ­¥ï¼‰
- **æ•°æ®å®‰å…¨**ï¼šMongoDB æƒé™æ§åˆ¶ï¼ˆä»…å®¢æˆ·ç«¯å¯è®¿é—®è‡ªå·±çš„æ•°æ®ï¼Œmethod æ£€æŸ¥ç”¨æˆ· IDï¼‰
- **æ‰©å±•æ€§**ï¼šæœªæ¥å¯æ— ç¼è¿ç§»åˆ° GraphQLï¼ˆApolloï¼‰
